{% extends 'core/base.html' %}
{% load static %}

{% block title %}{{ job.title }} at {{ job.company_name }} - CareerAI{% endblock %}

{% block content %}
<div class="container py-8">
    <!-- Breadcrumb-like back button -->
    <a href="{% url 'job_list' %}" class="btn btn-outline mb-8" style="padding: 0.5rem 1rem; border-width: 1px;">
        <i class="fas fa-arrow-left" style="margin-right: 0.5rem;"></i> Back to Jobs
    </a>

    <div class="grid grid-2" style="grid-template-columns: 2fr 1fr; align-items: start;">
        <!-- Left Column: Job Content -->
        <div class="card glass animate-text">
            <div class="flex flex-mobile-col justify-between items-start mb-6 gap-4">
                <span class="tag" style="padding: 0.5rem 1rem; font-size: 0.9rem;">{{ job.get_job_type_display }}</span>
                <span style="color: var(--text-muted); font-size: 0.9rem;">
                    <i class="far fa-calendar-alt"></i> Posted {{ job.posted_at|date:"M d, Y" }}
                </span>
            </div>

            <h1 class="job-detail-title">{{ job.title }}</h1>
            <p class="job-detail-company">
                <i class="fas fa-building"></i> {{ job.company_name }}
            </p>

            <div class="flex gap-6 mb-8" style="border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 1.5rem;">
                <div class="flex items-center gap-2">
                    <i class="fas fa-map-marker-alt" style="color: var(--accent);"></i>
                    <span>{{ job.location }}</span>
                </div>
                {% if job.salary_range %}
                <div class="flex items-center gap-2">
                    <i class="fas fa-money-bill-wave" style="color: var(--success);"></i>
                    <span>{{ job.salary_range }}</span>
                </div>
                {% endif %}
            </div>

            <div class="job-description-content" style="font-size: 1.1rem; line-height: 1.8;">
                <h3 style="margin-bottom: 1rem; color: var(--text-main);">Job Description</h3>
                <div style="color: var(--text-muted);">
                    {{ job.description|linebreaks }}
                </div>
            </div>
        </div>

        <!-- Right Column: Quick Info & Apply -->
        <div class="flex flex-col gap-6">
            <div class="card glass" style="border-color: var(--primary); border-width: 2px;">
                <h3 style="margin-bottom: 1rem;">Ready to Apply?</h3>
                <p style="color: var(--text-muted); font-size: 0.95rem; margin-bottom: 1.5rem;">
                    This link will take you directly to the company's official application page.
                </p>
                <a href="{{ job.apply_link }}" target="_blank" class="btn btn-primary pulse-btn" style="width: 100%; padding: 1rem;">
                    Apply Now <i class="fas fa-external-link-alt" style="margin-left: 0.5rem;"></i>
                </a>
            </div>

            <div class="card glass">
                <h3 style="margin-bottom: 1rem;">Job Snapshot</h3>
                <ul class="flex flex-col gap-4">
                    <li class="flex justify-between">
                        <span style="color: var(--text-muted);">Role Type</span>
                        <span style="font-weight: 600;">{{ job.get_job_type_display }}</span>
                    </li>
                    <li class="flex justify-between">
                        <span style="color: var(--text-muted);">Location</span>
                        <span style="font-weight: 600;">{{ job.location }}</span>
                    </li>
                    <li class="flex justify-between">
                        <span style="color: var(--text-muted);">Compensation</span>
                        <span style="font-weight: 600;">{{ job.salary_range|default:"Competitive" }}</span>
                    </li>
                    <li class="flex justify-between">
                        <span style="color: var(--text-muted);">Posted By</span>
                        <span style="font-weight: 600;">{{ job.posted_by.username|title|default:"Admin" }}</span>
                    </li>
                </ul>
            </div>

            {% if user.is_staff or user.is_superuser %}
            <div class="card" style="border-color: var(--error);">
                <h3 style="color: var(--error); margin-bottom: 1rem;">Admin Controls</h3>
                <a href="{% url 'delete_job' job.id %}" class="btn btn-danger" style="width: 100%;" onclick="return confirm('Are you sure you want to delete this job posting? This cannot be undone.');">
                    <i class="fas fa-trash"></i> Delete Posting
                </a>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
    .job-detail-title {
        font-size: 2.5rem;
        font-weight: 800;
        margin-bottom: 0.5rem;
        line-height: 1.2;
    }
    .job-detail-company {
        font-size: 1.5rem;
        color: var(--primary);
        font-weight: 600;
        margin-bottom: 1.5rem;
    }
    @media (max-width: 992px) {
        .grid-2 {
            grid-template-columns: 1fr !important;
        }
    }
    @media (max-width: 768px) {
        .job-detail-title {
            font-size: 1.85rem;
        }
        .job-detail-company {
            font-size: 1.25rem;
        }
    }
</style>
{% endblock %}
