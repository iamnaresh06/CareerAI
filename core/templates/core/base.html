{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}CareerAI{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'core/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
</head>
<body>

    {% include 'core/header.html' %}

    <div class="page-content">
        {% block content %}{% endblock %}
    </div>

    <footer class="site-footer">
    <div class="footer-content">
        <p class="copyright">
            Â© 2025 <strong>CareerAI</strong> | Developed by <strong>Naresh Reddy</strong>
        </p>

        <div class="footer-links">
            <a href="https://www.linkedin.com/in/iamnaresh06" target="_blank" aria-label="LinkedIn">
                <i class="fab fa-linkedin-in"></i>
            </a>

            <a href="https://github.com/iamnaresh06" target="_blank" aria-label="GitHub">
                <i class="fab fa-github"></i>
            </a>

            <a href="mailto:iamnaresh06@gmail.com" aria-label="Email">
                <i class="fas fa-envelope"></i>
            </a>
        </div>
    </div>
</footer>


<div id="career-bot">
    <button onclick="toggleBot()">ðŸ’¬ Career AI Bot</button>
    <div id="bot-box">
        <div id="bot-header">
            <span>CareerAI Assistant</span>
            <button onclick="clearChat()" title="Clear Chat">ðŸ—‘</button>
        </div>

        <div id="bot-messages"></div>

        <input type="text" id="bot-input"
            placeholder="Ask about your career..."
            onkeydown="if(event.key==='Enter') sendBotMessage()">
    </div>
</div>


<script>
function toggleBot() {
    document.getElementById("bot-box").classList.toggle("open");
}

function sendBotMessage() {
    const input = document.getElementById("bot-input");
    const msg = input.value.trim();
    if (!msg) return;

    const box = document.getElementById("bot-messages");

    // User message
    box.innerHTML += `<div><strong>You:</strong> ${msg}</div>`;
    input.value = "";

    fetch("{% url 'career_chatbot' %}", {
        method: "POST",
        headers: {
            "X-CSRFToken": "{{ csrf_token }}"
        },
        body: new URLSearchParams({ message: msg })
    })
    .then(res => res.json())
    .then(data => {
        const reply = data.reply;

        const botMsg = document.createElement("div");
        botMsg.innerHTML = "<strong>CareerAI:</strong><br>";
        botMsg.style.whiteSpace = "pre-line";
        box.appendChild(botMsg);

        let i = 0;
        const typing = setInterval(() => {
            if (i < reply.length) {
                botMsg.innerHTML += reply.charAt(i);
                i++;
                box.scrollTop = box.scrollHeight;
            } else {
                clearInterval(typing);
            }
        }, 15);
    });
}


function clearChat() {
    const box = document.getElementById("bot-messages");
    box.innerHTML = "<div><strong>CareerAI:</strong><br>Chat cleared. How can I help you now?</div>";
}

</script>

</body>
</html>