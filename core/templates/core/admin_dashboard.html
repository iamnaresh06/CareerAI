{% extends 'core/base.html' %}

{% block title %}Admin Dashboard - CareerAI{% endblock %}

{% block content %}
<div class="container py-8">
    <!-- Header with Mobile Wrap -->
    <div class="flex justify-between items-center mb-8 flex-mobile-col gap-6">
        <h1>Admin Dashboard</h1>
        <div class="flex gap-4 w-full-mobile">
            <a href="{% url 'post_job' %}" class="btn btn-outline" style="flex: 1;"><i class="fas fa-briefcase"></i> Post Job</a>
            <a href="{% url 'post_event' %}" class="btn btn-primary" style="flex: 1;"><i class="fas fa-calendar-plus"></i> Post Event</a>
        </div>
    </div>

    <!-- Stats with Bottom Borders -->
    <div class="grid grid-3" style="gap: 1.5rem; margin-bottom: 3rem;">
        <div class="card stat-card" style="border-bottom: 4px solid var(--primary);">
            <div class="stat-value" style="color: var(--primary);">{{ total_users }}</div>
            <div class="stat-label">Registered Users</div>
        </div>
        <a href="{% url 'job_list' %}" class="card stat-card" style="border-bottom: 4px solid var(--success); text-decoration: none; display: block; transition: transform 0.2s;">
            <div class="stat-value" style="color: var(--success);">{{ total_jobs }}</div>
            <div class="stat-label" style="color: var(--text-main);">Active Jobs <i class="fas fa-arrow-right" style="font-size: 0.8em; opacity: 0.7;"></i></div>
        </a>
        <a href="{% url 'event_list' %}" class="card stat-card" style="border-bottom: 4px solid var(--accent); text-decoration: none; display: block; transition: transform 0.2s;">
            <div class="stat-value" style="color: var(--accent);">{{ total_events }}</div>
            <div class="stat-label" style="color: var(--text-main);">Total Events <i class="fas fa-arrow-right" style="font-size: 0.8em; opacity: 0.7;"></i></div>
        </a>
    </div>

    <!-- Content Sections -->
    <div class="grid grid-2">
        <!-- Users List -->
        <div class="card" style="max-height: 500px; overflow-y: auto;">
            <h3 class="mb-4 text-lg"><i class="fas fa-users"></i> Recent Users</h3>
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: separate; border-spacing: 0 0.5rem;">
                    <tbody>
                        {% for u in users|slice:":10" %}
                        <tr style="background: var(--bg-surface); font-size: 0.9rem;">
                            <td style="padding: 0.75rem; border-radius: 6px 0 0 6px;">
                                <div style="font-weight: 600;">{{ u.username }}</div>
                                <div style="font-size: 0.8rem; color: var(--text-muted);">{{ u.email }}</div>
                            </td>
                            <td style="padding: 0.75rem; border-radius: 0 6px 6px 0; text-align: right;">
                                <span style="font-size: 0.8rem; color: var(--text-muted);">{{ u.date_joined|date:"M d" }}</span>
                                {% if u.is_superuser %}
                                <div class="tag" style="font-size: 0.6rem; padding: 0.1rem 0.4rem; background: var(--primary); color: white; display: inline-block; margin-left: 0.5rem;">Admin</div>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Postings Sections -->
        <div class="flex flex-col gap-8">
            <!-- Recent Jobs -->
            <div class="card">
                <h3 class="mb-4 text-lg"><i class="fas fa-briefcase"></i> Recent Postings</h3>
                <div style="display: flex; flex-direction: column; gap: 1.25rem;">
                    {% for job in jobs|slice:":4" %}
                    <div style="background: var(--bg-surface); padding: 1.5rem; border-radius: var(--radius-md); border: 1px solid rgba(0,0,0,0.05); display: flex; flex-direction: column; gap: 1rem;">
                        <div class="flex justify-between items-start" style="gap: 1rem;">
                            <div style="font-size: 1rem; font-weight: 700; padding-right: 0.5rem; line-height: 1.3;">{{ job.title }}</div>
                            <span style="font-size: 0.75rem; color: var(--primary); font-weight: 700; white-space: nowrap; text-transform: uppercase; letter-spacing: 0.5px;">{{ job.get_job_type_display }}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <small style="color: var(--text-muted); font-size: 0.9rem;">{{ job.company_name }}</small>
                            <a href="{% url 'delete_job' job.id %}" onclick="return confirm('Delete?');" 
                               style="background: rgba(239, 68, 68, 0.1); color: var(--error); padding: 0.4rem 1rem; border-radius: 6px; font-size: 0.85rem; font-weight: 600; display: inline-flex; align-items: center; gap: 0.4rem; transition: background 0.2s;">
                                <i class="fas fa-trash-alt"></i> Delete
                            </a>
                        </div>
                    </div>
                    {% empty %}
                    <p style="color: var(--text-muted); text-align: center;">No jobs yet.</p>
                    {% endfor %}
                </div>
            </div>

            <!-- Recent Events -->
            <div class="card">
                <h3 class="mb-4 text-lg"><i class="fas fa-calendar-alt"></i> Recent Events</h3>
                <div style="display: flex; flex-direction: column; gap: 1.25rem;">
                    {% for event in events|slice:":4" %}
                    <div style="background: var(--bg-surface); padding: 1.5rem; border-radius: var(--radius-md); border: 1px solid rgba(6, 182, 212, 0.1); display: flex; flex-direction: column; gap: 1rem;">
                        <div class="flex justify-between items-start" style="gap: 1rem;">
                            <div style="font-size: 1rem; font-weight: 700; padding-right: 0.5rem; line-height: 1.3;">{{ event.name }}</div>
                            <span style="font-size: 0.75rem; color: var(--accent); font-weight: 700; white-space: nowrap; text-transform: uppercase; letter-spacing: 0.5px;">{{ event.get_event_type_display }}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <small style="color: var(--text-muted); font-size: 0.9rem;">{{ event.date|date:"M d" }}</small>
                            <a href="{% url 'delete_event' event.id %}" onclick="return confirm('Delete?');" 
                               style="background: rgba(239, 68, 68, 0.1); color: var(--error); padding: 0.4rem 1rem; border-radius: 6px; font-size: 0.85rem; font-weight: 600; display: inline-flex; align-items: center; gap: 0.4rem; transition: background 0.2s;">
                                <i class="fas fa-trash-alt"></i> Delete
                            </a>
                        </div>
                    </div>
                    {% empty %}
                    <p style="color: var(--text-muted); text-align: center;">No events yet.</p>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    @media (max-width: 768px) {
        .text-lg { font-size: 1.1rem !important; }
        .flex-mobile-col { flex-direction: column; align-items: stretch; margin-bottom: 2rem !important; }
        h1 { margin-bottom: 1rem; text-align: center; font-size: 1.75rem; }
        .stat-value { font-size: 2rem !important; }
        .stat-card { padding: 1.25rem !important; margin-bottom: 0.5rem; }
        .w-full-mobile { width: 100%; display: flex; gap: 1rem; }
        
        td { display: block; width: 100%; text-align: left !important; padding: 0.75rem !important; border-radius: 0 !important; }
        tr { display: block; margin-bottom: 0.75rem; border-radius: 8px; border: 1px solid rgba(0,0,0,0.05); overflow: hidden; }
    }
</style>
{% endblock %}
